<p id="notice"><%= notice %></p>

<h1>Cohorts</h1>
<%if (@status)%>
  <%= @status %>
<%end%>

<%= form_with(url: filter_cohort_path, local: true) do |form| %>
  <div class="form-group">
    <%= form.label :'status:' %>
    <%= form.select :status, [['Ongoing', 0], ['Completed', 1], ['Setup', 2],['Archived', 3]], :class => "form-control" %>
  </div>
  <div class="form-group">
    <%= form.label :'program:' %>
    <%= form.select :program, [['Ongoing', 0], ['Completed', 1], ['Setup', 2],['Archived', 3]], :class => "form-control" %>
  </div>

  <div class="actions">
    <%= form.submit 'Filter',class: 'btn' %>
  </div>

<% end %>
<br>
<table class="table">
  <thead>
    <tr>
      <th>Title</th>
      <th>Slack</th>
      <th>Description</th>
      <th>Status</th>
      <th>Program</th>
      <th>Start Date</th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    <% @cohorts.each do |cohort| %>
      <%if(current_user.role>=1 || Registration.exists?(cohort_id: cohort.id, user_id: current_user.id))%>
        <%if(!@status || cohort.status == @status)%>
          <tr>
            <td><%= link_to cohort.title, cohort %></td>
            <td><%= cohort.slack %></td>
            <td><%= cohort.description %></td>

            <td><% if cohort.status == 0 %>
            Ongoing
          <% elsif cohort.status == 1 %>
            Completed
          <% elsif cohort.status == 2%>
            Setup
            <% else %>
            Archived
          <% end %></td>
            <td><%= cohort.program %></td>
            <td><%= cohort.start_date %></td>
            <td>
            <% if can? :show, cohort%>
              <%= link_to 'Show', cohort %>
            <% end %>
            <% if can? :edit, cohort%>
              <%= link_to 'Edit', edit_cohort_path(cohort) %>
            <% end %>
            <% if can? :destroy, cohort%>
              <%= link_to 'Destroy', cohort, method: :delete, data: { confirm: 'Are you sure?' } %>
            <% end %>
            </td>
          </tr>
        <% end %>
      <% end %>
    <%end%>
  </tbody>
</table>

<br>
<% if can? :new , @cohort%>
<%= link_to 'New Cohort', new_cohort_path, class: "btn" %>
<% end %>